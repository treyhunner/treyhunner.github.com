<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: javascript | Trey Hunner]]></title>
  <link href="https://treyhunner.com/blog/categories/javascript/atom.xml" rel="self"/>
  <link href="https://treyhunner.com/"/>
  <updated>2022-11-23T10:44:38-08:00</updated>
  <id>https://treyhunner.com/</id>
  <author>
    <name><![CDATA[Trey Hunner]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Deploying an Ember CLI application through SSH]]></title>
    <link href="https://treyhunner.com/2015/03/deploying-an-ember-cli-application-via-ssh/"/>
    <updated>2015-03-10T12:30:00-07:00</updated>
    <id>https://treyhunner.com/2015/03/deploying-an-ember-cli-application-via-ssh</id>
    <content type="html"><![CDATA[<p>Want to serve up your <a href="http://ember-cli.com">Ember CLI</a> application via Nginx/Apache or another web server software?  Let&rsquo;s learn how!</p>

<p><strong>TLDR:</strong> I made an Ember-CLI-Deploy adapter for deploying over SSH: <a href="https://github.com/treyhunner/ember-deploy-ssh-index">ember-deploy-ssh-index</a></p>

<h2>Ember-CLI-Deploy</h2>

<p><a href="https://github.com/ember-cli/ember-cli-deploy">Ember-CLI-Deploy</a> is &ldquo;an Ember CLI addon for lightning fast deployments of Ember CLI apps&rdquo;.  Using Ember-CLI-Deploy is preferable using to another static asset deployment solution because <em>it caters to the needs of an Ember CLI app</em>.</p>

<p>Last week at EmberConf 2015, Luke Melia <a href="https://www.youtube.com/watch?v=4EDetv_Rw5U">announced during his talk</a> that the three big competing Ember-CLI deployment solutions (Ember-Deploy, Front-End-Builds, and Ember-CLI-Deploy) will be merging into a single Ember-CLI-Deploy package based largely on Ember-Deploy.  Luke&rsquo;s talk inspired me to finally look into using <a href="https://github.com/ember-cli/ember-cli-deploy">Ember-CLI-Deploy</a> for deployment.</p>

<p>Note that whenever you see &ldquo;Ember-Deploy&rdquo; post you can now treat this as synonymous with &ldquo;Ember-CLI-Deploy&rdquo;.</p>

<h2>Why SSH instead of S3?</h2>

<p>You can host your entire front-end website on Amazon S3 with <a href="https://github.com/Kerry350/ember-deploy-s3-index">ember-deploy-s3-index</a> and <a href="https://github.com/LevelbossMike/ember-deploy-s3">ember-deploy-s3</a>.  If you use Ember CLI&rsquo;s default location behavior, your routes will use non-hash URLs on modern browsers (e.g. <a href="https://freemusic.ninja/resources">/resources</a> instead of <a href="https://freemusic.ninja/#/resources">/#/resources</a>).  This means that you need S3 to properly serve up all of your routes (not just the <code>/</code> path).</p>

<p>As an AWS beginner, the easiest solution I found for using S3 for hosting an Ember app with non-hash URLs is to set the 404 page to <code>index.html</code>.  This serves up the correct pages but returns a 404 status code for all routes besides the base <code>/</code> URL, which is obviously not ideal.</p>

<p>After failing to find a simple and elegant solution using an S3 bucket for my Ember CLI app&rsquo;s <code>index.html</code> file, I decided to move it onto my server and serve it through Nginx.</p>

<p><strong>UPDATE:</strong> You <em>can</em> use non-hash URLs with S3 without returning 404 status codes.  Michael Klein opened <a href="https://github.com/Kerry350/ember-deploy-s3-index/pull/12/files">a pull request</a> for ember-deploy-s3-index noting how</p>

<h2>Ember-Deploy-SSH-Index</h2>

<p>I went looking for an Ember-CLI-Deploy adapter that would allow my to upload my files to a directory on my web server, but I didn&rsquo;t find any such adapters.</p>

<p>Inspired by Kerry Gallagher&rsquo;s blog posts about <a href="http://kerrygallagher.co.uk/the-making-of-ember-deploy-s3-index/">the making of ember-deploy-s3-index</a> and <a href="http://kerrygallagher.co.uk/making-ember-deploy-adapters/">making Ember-Deploy adapters</a>, I decided to try making my own adapter.  My adapter, called <a href="https://github.com/treyhunner/ember-deploy-ssh-index">ember-deploy-ssh-index</a>, allows deploying your Ember CLI index page to a web server via SSH.</p>

<p>After looking for Node.js-based SSH/SCP/Rsync libraries, I decided to use the <a href="https://github.com/mscdex/ssh2">ssh2</a> library (a pure JS SSH implementation) to manage the SSH connections.  I looked at the in-progress Ember-CLI-Deploy <a href="https://github.com/ember-cli/ember-cli-deploy#index-adapters">documentation</a>, and the <a href="https://github.com/Kerry350/ember-deploy-s3-index">ember-deploy-s3-index</a> code to determine how my adapter should work.</p>

<p>Following the Ember-CLI-Deploy API, my library includes:</p>

<ul>
<li>an <code>upload</code> function that uploads the current index page to a file named based on the Ember-CLI-Deploy <a href="https://github.com/ember-cli/ember-cli-deploy#tagging-adapters">tag</a> (the git hash)</li>
<li>a <code>list</code> function that lists the files in the remote directory on the server</li>
<li>an <code>activate</code> function that links the <code>index.html</code> file to a given revision file</li>
</ul>


<h2>Usage</h2>

<p>You can use <a href="https://github.com/treyhunner/ember-deploy-ssh-index">ember-deploy-ssh-index</a> and <a href="https://github.com/LevelbossMike/ember-deploy-s3">ember-deploy-s3</a> to host your static assets on S3 and your index page through your own web server.</p>

<p>First, install Ember-CLI-Deploy and the adapters into your Ember CLI app:</p>

<pre><code class="bash">$ npm install --save-dev ember-cli-deploy ember-deploy-ssh-index ember-deploy-s3
</code></pre>

<p>Now make a <code>config/deploy.js</code> file with your SSH and S3 configuration.  I prefer to store my AWS credentials and SSH private key filename in environment variables, but a gitignore&rsquo;d configuration file or Node.js module would work as well.</p>

<pre><code class="js">/* jshint node: true */

module.exports = {
  production: {
    store: {
      type: 'ssh',
      remoteDir: '/var/www/',
      host: 'example.com',
      username: 'root',
      privateKeyFile: process.env.SSH_KEY_FILE,
    },
    assets: {
      type: 's3',
      accessKeyId: process.env.AWS_KEY,
      secretAccessKey: process.env.AWS_SECRET,
      bucket: 'assets.example.com',
    },
  },
  development: {
    // Add a development configuration here, similar to the production one above
  },
};
</code></pre>

<p>Because we&rsquo;re storing our static assets at a different base URL from our index page, we&rsquo;ll need to prepend a base URL to our asset paths.  Let&rsquo;s update our <code>EmberApp</code> definition in our <code>Brocfile.js</code> to reflect that change:</p>

<pre><code class="js">var app = new EmberApp({
  fingerprint: {
    prepend: 'https://s3.amazonaws.com/assets.example.com/',
  },
});
</code></pre>

<p>Now we should be able to upload our application:</p>

<pre><code class="bash">$ ember deploy -e production
</code></pre>

<p>And activate our current revision (change <code>example</code> to your app name):</p>

<pre><code class="bash">$ export tag="example:$(git rev-parse --short HEAD)"
$ ember deploy:activate --revision $tag --environment production
</code></pre>

<p>Take a look at the <a href="https://github.com/treyhunner/ember-deploy-ssh-index#readme">README file</a> for more documentation on the usage of <a href="https://github.com/treyhunner/ember-deploy-ssh-index">ember-deploy-ssh-index</a>.</p>

<h2>Next Steps</h2>

<p><a href="https://github.com/treyhunner/ember-deploy-ssh-index">ember-deploy-ssh-index</a> is the first <a href="http://ember-cli.com">Ember CLI</a>-related NPM module I have made.  I have only used it to deploy a single website, <a href="https://freemusic.ninja/">Free Music Ninja</a> (<a href="https://github.com/FreeMusicNinja/freemusic.ninja">code here</a>).  I have also not yet written any tests for this adapter so it&rsquo;s probably buggy.</p>

<p>My future plans include:</p>

<ol>
<li><a href="https://github.com/treyhunner/ember-deploy-ssh-index/issues/3">Write tests.</a>  <q>Code without tests is broken by design</q> - <cite>Jacob Kaplan Moss</cite></li>
<li><a href="https://github.com/treyhunner/ember-deploy-ssh-index/issues/10">Possibly rename app</a>: <code>ember-deploy-ssh-index</code> to <code>ember-cli-deploy-ssh-index</code></li>
<li><a href="https://github.com/treyhunner/ember-deploy-ssh-index/issues/7">Support SSH config file</a> (<code>~/.ssh/config</code>)</li>
</ol>


<p>At this point I am the only person who has worked with this adapter and I would love some feedback!  Have an opinion or want to help improve this adapter?  <strong>Please open an issue, comment below, tweet me, or email me.</strong></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Creating a custom Bootstrap build]]></title>
    <link href="https://treyhunner.com/2015/02/creating-a-custom-bootstrap-build/"/>
    <updated>2015-02-25T16:20:00-08:00</updated>
    <id>https://treyhunner.com/2015/02/creating-a-custom-bootstrap-build</id>
    <content type="html"><![CDATA[<p>Have you ever tried to customize the font size for your <a href="http://getbootstrap.com/">Bootstrap</a>-powered website?</p>

<p>It&rsquo;s not something you can easily do without recompiling Bootstrap&rsquo;s CSS. If you change the font size on your page, you&rsquo;ll want that change to cascade through.  A change in the base font size should recalculate header font sizes and margins/padding for text elements like paragraph tags.</p>

<p>Let&rsquo;s look at how to create a custom <a href="https://github.com/twbs/bootstrap-sass">Bootstrap SASS</a> build without maintaining our own fork of Bootstrap.</p>

<h2>Using Bootstrap with Bower</h2>

<p>We&rsquo;re going to use <code>bower</code> and <code>gulp</code> to compile Bootstrap, so we&rsquo;ll need <a href="http://nodejs.org/">Node.js</a>.</p>

<p>First let&rsquo;s make a <code>package.json</code> file for Node to see.  Either use <code>npm init -y</code> or create a <code>package.json</code> file containing just an empty JSON object (<code>{}</code>).</p>

<p>Now let&rsquo;s install <code>gulp</code>, <code>gulp-bower</code>, and <code>gulp-sass</code>:</p>

<pre><code>$ npm install --save-dev gulp gulp-bower gulp-sass
</code></pre>

<p>Our <code>package.json</code> file should now look something like this:</p>

<p><figure class='code'><figcaption><span>package.json </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="err">&amp;ldquo;devDependencies&amp;rdquo;:</span> <span class="err">{</span>
</span><span class='line'>    <span class="err">&amp;ldquo;gulp&amp;rdquo;:</span> <span class="err">&amp;ldquo;^3.8.11&amp;rdquo;,</span>
</span><span class='line'>    <span class="err">&amp;ldquo;gulp-bower&amp;rdquo;:</span> <span class="err">&amp;ldquo;0.0.10&amp;rdquo;,</span>
</span><span class='line'>    <span class="err">&amp;ldquo;gulp-sass&amp;rdquo;:</span> <span class="err">&amp;ldquo;^1.3.3&amp;rdquo;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="err">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Now let&rsquo;s use Bower to install bootstrap.  This will allow us to import Bootstrap into our SCSS code and compile it down to CSS manually.</p>

<p>Create a <code>bower.json</code> file using <code>bower init</code> or by manually creating one:</p>

<p><figure class='code'><figcaption><span>bower.json </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="err">&amp;ldquo;name&amp;rdquo;:</span> <span class="err">&amp;ldquo;custom-bootstrap-example&amp;rdquo;,</span>
</span><span class='line'>  <span class="err">&amp;ldquo;authors&amp;rdquo;:</span> <span class="err">[</span>
</span><span class='line'>    <span class="err">&amp;ldquo;Lillian</span> <span class="err">Langston</span> <span class="err">&lt;a</span> <span class="err">href=</span><span class="nt">&quot;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#x74;&amp;#x6f;&amp;#58;&amp;#x6c;&amp;#105;&amp;#108;&amp;#x6c;&amp;#x69;&amp;#x61;&amp;#110;&amp;#64;&amp;#x65;&amp;#120;&amp;#x61;&amp;#109;&amp;#x70;&amp;#108;&amp;#101;&amp;#x2e;&amp;#x63;&amp;#x6f;&amp;#x6d;&quot;</span><span class="err">&gt;&amp;#x</span><span class="mi">6</span><span class="err">c;&amp;#x</span><span class="mi">69</span><span class="err">;&amp;#</span><span class="mi">108</span><span class="err">;&amp;#x</span><span class="mi">6</span><span class="err">c;&amp;#</span><span class="mi">105</span><span class="err">;&amp;#x</span><span class="mi">61</span><span class="err">;&amp;#</span><span class="mi">110</span><span class="err">;&amp;#</span><span class="mi">64</span><span class="err">;&amp;#</span><span class="mi">101</span><span class="err">;&amp;#</span><span class="mi">120</span><span class="err">;&amp;#x</span><span class="mi">61</span><span class="err">;&amp;#</span><span class="mi">109</span><span class="err">;&amp;#x</span><span class="mi">70</span><span class="err">;&amp;#</span><span class="mi">108</span><span class="err">;&amp;#</span><span class="mi">101</span><span class="err">;&amp;#x</span><span class="mi">2</span><span class="err">e;&amp;#x</span><span class="mi">63</span><span class="err">;&amp;#x</span><span class="mi">6</span><span class="err">f;&amp;#x</span><span class="mi">6</span><span class="err">d;&lt;/a&gt;&amp;rdquo;</span>
</span><span class='line'>  <span class="err">]</span><span class="p">,</span>
</span><span class='line'>  <span class="err">&amp;ldquo;private&amp;rdquo;:</span> <span class="err">true,</span>
</span><span class='line'>  <span class="err">&amp;ldquo;ignore&amp;rdquo;:</span> <span class="err">[</span>
</span><span class='line'>    <span class="err">&amp;ldquo;&lt;em&gt;*/.&lt;/em&gt;&amp;rdquo;,</span>
</span><span class='line'>    <span class="err">&amp;ldquo;node_modules&amp;rdquo;,</span>
</span><span class='line'>    <span class="err">&amp;ldquo;bower_components&amp;rdquo;,</span>
</span><span class='line'>    <span class="err">&amp;ldquo;test&amp;rdquo;,</span>
</span><span class='line'>    <span class="err">&amp;ldquo;tests&amp;rdquo;</span>
</span><span class='line'>  <span class="err">],</span>
</span><span class='line'>  <span class="err">&amp;ldquo;dependencies&amp;rdquo;:</span> <span class="err">{</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="err">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Now let&rsquo;s install <code>bootstrap-sass</code> with Bower.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>bower install <span class="p">&amp;</span>ndash<span class="p">;</span>save bootstrap-sass
</span></code></pre></td></tr></table></div></figure></p>

<p>Our <code>bower.json</code> file should now have <code>bootstrap-sass</code> listed as a dependency:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&ldquo;dependencies&rdquo;: {
</span><span class='line'>  &ldquo;bootstrap-sass&rdquo;: &ldquo;~3.3.3&rdquo;
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure></p>

<p>Now we can make an SCSS file that includes bootstrap into our project.  Let&rsquo;s call our SCSS file <code>css/app.scss</code>:</p>

<p><figure class='code'><figcaption><span>css/app.scss </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='scss'><span class='line'><span class="k">@import</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="nt">bootstrap</span><span class="k">&amp;</span><span class="nt">rdquo</span><span class="o">;;</span>
</span><span class='line'><span class="o">@</span><span class="nt">import</span> <span class="k">&amp;</span><span class="nt">ldquo</span><span class="o">;</span><span class="nt">bootstrap</span><span class="o">/</span><span class="nt">theme</span><span class="k">&amp;</span><span class="nt">rdquo</span><span class="o">;;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Now let&rsquo;s use gulp to compile our <code>app.scss</code> which includes Bootstrap SASS:</p>

<p><figure class='code'><figcaption><span>gulpfile.js </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="kd">var</span> <span class="nx">gulp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">gulp</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">sass</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">gulp</span><span class="o">-</span><span class="nx">sass</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="kd">var</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">bootstrapDir</span><span class="o">:</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;.</span><span class="o">/</span><span class="nx">bower_components</span><span class="o">/</span><span class="nx">bootstrap</span><span class="o">-</span><span class="nx">sass</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span>
</span><span class='line'>    <span class="nx">publicDir</span><span class="o">:</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;.</span><span class="o">/</span><span class="kr">public</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span>
</span><span class='line'><span class="p">};</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">css</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;.</span><span class="o">/</span><span class="nx">css</span><span class="o">/</span><span class="nx">app</span><span class="p">.</span><span class="nx">scss</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">sass</span><span class="p">({</span>
</span><span class='line'>        <span class="nx">includePaths</span><span class="o">:</span> <span class="p">[</span><span class="nx">config</span><span class="p">.</span><span class="nx">bootstrapDir</span> <span class="o">+</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="err">/assets/stylesheets&amp;rsquo;],</span>
</span><span class='line'>    <span class="p">}))</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">publicDir</span> <span class="o">+</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="err">/css&amp;rsquo;));</span>
</span><span class='line'><span class="p">});</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">fonts</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">bootstrapDir</span> <span class="o">+</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="err">/assets/fonts/&lt;em&gt;*/&lt;/em&gt;&amp;rsquo;)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">dest</span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">publicDir</span> <span class="o">+</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="err">/fonts&amp;rsquo;));</span>
</span><span class='line'><span class="p">});</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="k">default</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="p">[</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">css</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">fonts</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;]);</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Now when we run <code>gulp</code>, our compiled Bootstrap CSS should appear in the <code>public/css</code> directory:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>gulp
</span><span class='line'><span class="nv">$ </span>ls public/css
</span><span class='line'>app.css
</span></code></pre></td></tr></table></div></figure></p>

<h2>Customizing the font size</h2>

<p>Now let&rsquo;s look at how we can go about customizing the font size in Bootstrap.</p>

<p>Notice that the value of the <code>$font-size-base</code> variable in the <a href="https://github.com/twbs/bootstrap-sass/blob/master/assets/stylesheets/bootstrap/_variables.scss#L52"><code>_variables.scss</code> file</a> is used for calculating a variety of other important variables.  For example 8 of the lines below rely on <code>$font-size-base</code>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='scss'><span class='line'><span class="nv">$font-size-base</span><span class="o">:</span>          <span class="mi">14</span><span class="kt">px</span> <span class="nv">!default</span><span class="p">;</span>
</span><span class='line'><span class="nv">$font-size-large</span><span class="o">:</span>         <span class="nf">ceil</span><span class="p">((</span><span class="nv">$font-size-base</span> <span class="o">*</span> <span class="mi">1</span><span class="mf">.25</span><span class="p">))</span> <span class="nv">!default</span><span class="p">;</span> <span class="c1">// ~18px</span>
</span><span class='line'><span class="nv">$font-size-small</span><span class="o">:</span>         <span class="nf">ceil</span><span class="p">((</span><span class="nv">$font-size-base</span> <span class="o">*</span> <span class="mi">0</span><span class="mf">.85</span><span class="p">))</span> <span class="nv">!default</span><span class="p">;</span> <span class="c1">// ~12px&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="na">&lt;p&gt;$font-size-h1</span><span class="o">:</span>            <span class="nf">floor</span><span class="p">((</span><span class="nv">$font-size-base</span> <span class="o">*</span> <span class="mi">2</span><span class="mf">.6</span><span class="p">))</span> <span class="nv">!default</span><span class="p">;</span> <span class="c1">// ~36px</span>
</span><span class='line'><span class="nv">$font-size-h2</span><span class="o">:</span>            <span class="nf">floor</span><span class="p">((</span><span class="nv">$font-size-base</span> <span class="o">*</span> <span class="mi">2</span><span class="mf">.15</span><span class="p">))</span> <span class="nv">!default</span><span class="p">;</span> <span class="c1">// ~30px</span>
</span><span class='line'><span class="nv">$font-size-h3</span><span class="o">:</span>            <span class="nf">ceil</span><span class="p">((</span><span class="nv">$font-size-base</span> <span class="o">*</span> <span class="mi">1</span><span class="mf">.7</span><span class="p">))</span> <span class="nv">!default</span><span class="p">;</span> <span class="c1">// ~24px</span>
</span><span class='line'><span class="nv">$font-size-h4</span><span class="o">:</span>            <span class="nf">ceil</span><span class="p">((</span><span class="nv">$font-size-base</span> <span class="o">*</span> <span class="mi">1</span><span class="mf">.25</span><span class="p">))</span> <span class="nv">!default</span><span class="p">;</span> <span class="c1">// ~18px</span>
</span><span class='line'><span class="nv">$font-size-h5</span><span class="o">:</span>            <span class="nv">$font-size-base</span> <span class="nv">!default</span><span class="p">;</span>
</span><span class='line'><span class="nv">$font-size-h6</span><span class="o">:</span>            <span class="nf">ceil</span><span class="p">((</span><span class="nv">$font-size-base</span> <span class="o">*</span> <span class="mi">0</span><span class="mf">.85</span><span class="p">))</span> <span class="nv">!default</span><span class="p">;</span> <span class="c1">// ~12px</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Notice those <code>!default</code> flags?  That <code>!default</code> flag means the variables will be set <em>only</em> if they don&rsquo;t have a value already.</p>

<p>All of the variables assigned in <a href="https://github.com/twbs/bootstrap-sass">Bootstrap SASS&rsquo;s</a> <code>_variables.scss</code> file have a <code>!default</code> flag.  That means we can override those variables by assigning our own values before we import Bootstrap.</p>

<p>Let&rsquo;s copy Bootstrap&rsquo;s <code>_variables.scss</code> file and make our own custom version:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>cp bower_components/bootstrap-sass/assets/stylesheets/bootstrap/&lt;em&gt;variables.scss css/&lt;/em&gt;variables.scss
</span></code></pre></td></tr></table></div></figure></p>

<p>Now we need to reference our custom variables module from our <code>app.scss</code> file.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='scss'><span class='line'><span class="k">@import</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="nt">variables</span><span class="k">&amp;</span><span class="nt">rdquo</span><span class="o">;;</span>
</span><span class='line'><span class="o">@</span><span class="nt">import</span> <span class="k">&amp;</span><span class="nt">ldquo</span><span class="o">;</span><span class="nt">bootstrap</span><span class="k">&amp;</span><span class="nt">rdquo</span><span class="o">;;</span>
</span><span class='line'><span class="o">@</span><span class="nt">import</span> <span class="k">&amp;</span><span class="nt">ldquo</span><span class="o">;</span><span class="nt">bootstrap</span><span class="o">/</span><span class="nt">theme</span><span class="k">&amp;</span><span class="nt">rdquo</span><span class="o">;;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Remember to import our <code>variables</code> module <em>before</em> we import Bootstrap!  If we import it afterward, our changes customizations won&rsquo;t be applied.</p>

<p>Now let&rsquo;s change <code>$font-size-base</code> to <code>16px</code> in <code>css/_variables.scss</code>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scss'><span class='line'><span class="nv">$font-size-base</span><span class="o">:</span>          <span class="mi">16</span><span class="kt">px</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Now if we recompile our CSS we should see our larger font size reflected throughout our application:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>gulp
</span></code></pre></td></tr></table></div></figure></p>

<h2>Try it out!</h2>

<p>I made a sample project to demonstrate how easy it is to customize Bootstrap variables before building <a href="https://github.com/twbs/bootstrap-sass">Bootstrap SASS</a>.</p>

<p><a href="https://github.com/treyhunner/custom-bootstrap-example">Check out the sample project on Github</a></p>

<p>Know about a different way to customize Bootstrap?  Did I make a mistake in my explanation?  Leave a comment and let me know.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ECMAScript 5: The Future is Now]]></title>
    <link href="https://treyhunner.com/2015/02/ecmascript-5-the-future-is-now/"/>
    <updated>2015-02-09T00:00:00-08:00</updated>
    <id>https://treyhunner.com/2015/02/ecmascript-5-the-future-is-now</id>
    <content type="html"><![CDATA[<p>ECMAScript 5 was finalized over five years ago and it is well supported in all modern browsers.  So, with ECMAScript 6 nearing standardization, let&rsquo;s talk about ECMAScript 5.</p>

<p>Do you know what features were added in ECMAScript 5?</p>

<p>Do your target browsers support ECMAScript 5 yet?</p>

<p><aside>
    <dfn>ECMAScript</dfn> is a scripting language standardized by <abbr title="European Computer Manufacturers Association">Ecma</abbr> International and is the core specification of the JavaScript language.
</aside></p>

<h2>Arrays</h2>

<p><a href="http://underscorejs.org/">Underscore.js</a> is a popular JavaScript library containing &ldquo;a whole mess of useful functional programming helpers&rdquo;.  Most of these helpers work on arrays and other enumerable objects (collections, as Underscore calls them).</p>

<p>The ECMAScript 5 spec includes a handful of these functional programming helpers as methods on native JavaScript Array objects.</p>

<ul>
<li><p><strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf"><code>indexOf</code></a></strong> and <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/lastIndexOf"><code>lastIndexOf</code></a></strong>, like <a href="http://underscorejs.org/#indexOf"><code>_.indexOf</code></a> and <a href="http://underscorejs.org/#lastIndexOf"><code>_.lastIndexOf</code></a>, return the index (or last index) at which a value can be found in the array</p></li>
<li><p><strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/every"><code>every</code></a></strong>, like <a href="http://underscorejs.org/#every"><code>_.every</code></a>, returns true if <strong>all</strong> the values in the array pass the test implemented by the provided function</p></li>
<li><p><strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/some"><code>some</code></a></strong>, like <a href="http://underscorejs.org/#some"><code>_.some</code></a>, returns true if <strong>any</strong> of the values in the array pass the test implemented by the provided function</p></li>
<li><p><strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach"><code>forEach</code></a></strong>, like <a href="http://underscorejs.org/#each"><code>_.each</code></a>, executes a provided function once for each array item</p></li>
<li><p><strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map"><code>map</code></a></strong>, like <a href="http://underscorejs.org/#map"><code>_.map</code></a>, returns a new array with the results of calling a provided function on each item of the array</p></li>
<li><p><strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter"><code>filter</code></a></strong>, like <a href="http://underscorejs.org/#filter"><code>_.filter</code></a>, returns a new array with all array items that pass the given test function included.</p></li>
<li><p><strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce"><code>reduce</code></a></strong> and <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduceRight"><code>reduceRight</code></a></strong>, like <a href="http://underscorejs.org/#reduce"><code>_.reduce</code></a> and <a href="http://underscorejs.org/#reduceRight"><code>_.reduceRight</code></a>, reduce a list of values into a single value using an accumulator function (either left-to-right or right-to-left)</p></li>
</ul>


<h2>Miscellaneous</h2>

<p>Here are a variety of other features that were added to ECMAScript 5, in addition to array helper functions:</p>

<ul>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys"><code>Object.keys</code></a>, like <a href="http://underscorejs.org/#keys"><code>_.keys</code></a>, returns an array of a given object&rsquo;s enumerable properties</p></li>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray"><code>Array.isArray</code></a>, like <a href="http://underscorejs.org/#isArray"><code>_.isArray</code></a>, returns <code>true</code> if a given object is an array</p></li>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/now"><code>Date.now</code></a>, like <a href="http://underscorejs.org/#now"><code>_.now</code></a> returns the number of milliseconds elapsed since 1 January 1970 00:00:00 UTC</p></li>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify"><code>JSON.stringify</code></a> converts JavaScript objects to JSON strings and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse"><code>JSON.parse</code></a> converts JSON strings to JavaScript objects.</p></li>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind"><code>Function.prototype.bind</code></a>, like <a href="http://underscorejs.org/#bind"><code>_.bind</code></a>, returns a function that when called has its <code>this</code> keyword argument set to the provided value</p></li>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/trim"><code>String.prototype.trim</code></a>, returns a copy of the string with whitespace removed from the beginning and end of the string</p></li>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/parseInt"><code>parseInt</code></a> no longer treats strings starting with <code>0</code> as octal values</p></li>
<li><p>Strict mode, Object.create, Object.seal, Object.freeze, getters/setters, and more were also added in ECMAScript 5</p></li>
</ul>


<h2>Underscore.js vs Native</h2>

<p>I try to use native array methods instead of their Underscore.js equivalents whenever possible.  However, these native array methods don&rsquo;t work in all cases.</p>

<h3>Not all enumerables are arrays</h3>

<p>Here&rsquo;s two enumerable objects which are not arrays:</p>

<ol>
<li>NodeList objects in the browser</li>
<li>File buffers in Node.js</li>
</ol>


<p>You cannot use array methods like <code>forEach</code> on these enumerables, but you can the Underscore.js equivalents like <code>_.each</code>.</p>

<h3>So why not use Underscore for everything?</h3>

<h4>Native methods are more understandable</h4>

<p>Web developers know JavaScript.  Web developers may not Underscore or your Underscore-like library of choice.  Don&rsquo;t stray far from vanilla JavaScript when you don&rsquo;t need to.</p>

<h4>Underscore is less portable</h4>

<p>Underscore doesn&rsquo;t come bundled with your rendering engine.</p>

<h4>Native methods are future-proof</h4>

<p>Underscore is cool today, but <a href="https://github.com/lodash/lodash">lodash</a> might be cooler tomorrow.  Or maybe you&rsquo;d prefer to use <a href="https://github.com/cmstead/JFP">JFP</a>.</p>

<h4>Native methods can be faster</h4>

<p>As browser engines improve their optimization of native code, your code improves in speed.  Underscore&rsquo;s equivalents of these methods cannot be further optimized at the low-level as their native equivalents.</p>

<p>This claim as a theoretical one.  Here&rsquo;s some jsPerf links to test the real performance difference:</p>

<ul>
<li><a href="http://jsperf.com/array-prototype-indexof-vs-indexof">indexOf</a> and <a href="http://jsperf.com/array-prototype-lastindexof-vs-lastindexof">lastIndexOf</a></li>
<li><a href="http://jsperf.com/array-prototype-every-vs-every">every</a></li>
<li><a href="http://jsperf.com/array-prototype-some-vs-some2">some</a></li>
<li><a href="http://jsperf.com/array-prototype-foreach-vs-each">forEach</a></li>
<li><a href="http://jsperf.com/array-prototype-map-vs-map">map</a></li>
<li><a href="http://jsperf.com/array-prototype-filter-vs-filter">filter</a></li>
<li><a href="http://jsperf.com/array-prototype-reduce-vs-reduce">reduce</a> and <a href="http://jsperf.com/array-prototype-reduceright-vs-reduceright">reduceRight</a></li>
</ul>


<h2>What browsers support ECMAScript 5?</h2>

<p>ECMAScript 5 is fully supported in Internet Explorer 10 and nearly fully supported in IE9.  Modern versions of Chrome and Firefox also fully support ECMAScript 5.</p>

<h4>What if you need to support IE7 or IE8?</h4>

<p>Fortunately, all of the array methods discussed above and some of the other ECMAScript 5 features can be <a href="https://remysharp.com/2010/10/08/what-is-a-polyfill">polyfilled</a> using <a href="https://github.com/es-shims/es5-shim">es5-shim</a>.</p>

<h4>ECMAScript 5 all the things!</h4>

<p>With these pollyfills in place, you should be able to use the majority of ECMAScript 5 features everywhere.  Go forth and ES5-ify your code!</p>

<p><aside>
This blog post was based on my ECMAScript 5 talk.  You can view the slides at <a href="http://treyhunner.com/es5-talk/">http://treyhunner.com/es5-talk/</a>
</aside></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Replacement for jQuery AlphaNumeric plugin]]></title>
    <link href="https://treyhunner.com/2010/10/replacement-for-jquery-alphanumeric-plugin/"/>
    <updated>2010-10-18T00:00:00-07:00</updated>
    <id>https://treyhunner.com/2010/10/replacement-for-jquery-alphanumeric-plugin</id>
    <content type="html"><![CDATA[<p>I recently inherited a codebase that used the <a href="http://plugins.jquery.com/project/aphanumeric">jQuery AlphaNumeric plugin</a> extensively.  This plugin can be used to restrict users from entering certain characters into a form field.   The functions included for this plugin (<strong>alphanumeric</strong>, <strong>alpha</strong>, and <strong>numeric</strong>) claim to allow only alphabetic and/or numeric characters to be entered in the form field being acted on.</p>

<p>Unfortunately, this plugin is ineffectual.  I have witnessed unexpected behaviors of varying significance associated with this plugin:</p>

<ol>
<li>Forbidden characters can be input by pasting with CTRL+V in Chrome</li>
<li>Forbidden characters can be input by selecting Edit-&gt;Paste in Firefox and IE</li>
<li>Forbidden characters can be input by middle-click pasting in Linux</li>
<li>The arrow keys, Home button, End button, and Delete button do not work in input fields using this plugin&rsquo;s functions in Firefox</li>
<li>The context menu is disabled (right clicking on an input field does nothing)</li>
<li>And most importantly, instead of using a list of allowed characters, a list of disallowed characters is used so these are the only characters that are actually forbidden:

<blockquote><p>!@#$%^&amp;*()+=[]&lsquo;;,/{}|&ldquo;:?~`.-</p></blockquote></li>
</ol>


<p>The code is so brief that patching the current plugin would be pointless, so instead I wrote <a href="http://github.com/treyhunner/jquery-formrestrict">a replacement</a> that acts similar enough that I did not have to change any of our pre-existing code that depended on the AlphaNumeric plugin.</p>

<p>First I created <strong>restrict</strong>, a very basic modifier function that takes a sanitizer function as an argument.  The sanitizer function should manipulate the string to be valid input (if it was not already) and return the valid version of this input.  The <strong>restrict</strong> function is triggered whenever the input field is altered and will immediately replace the text in the field with sanitized text.</p>

<p>Most of the restricts I would want to use on an input field can be represented by a regular expression, so I created the <strong>regexRestrict</strong> function that takes a regular expression as input and uses <strong>restrict</strong> to replace matches to this regular expression found in the string.</p>

<p>The <strong>restrict</strong> and <strong>regexRestrict</strong> functions provide every feature that the AlphaNumeric plugin promises, but they don&rsquo;t use the same syntax as the AlphaNumeric plugin.  To be able to drop this plugin into a codebase that currently uses the AlphaNumeric plugin, we&rsquo;d need an equivalent to the <strong>alphanumeric</strong>, <strong>alpha</strong>, and <strong>numeric</strong> functions with all of their <a href="http://itgroup.com.ph/alphanumeric/">stated features</a>.  To allow the code that relied on the AlphaNumeric plugin to continue functioning, I created replacements for all three of these functions.  These functions take the same inputs as their AlphaNumeric plugin equivalents.</p>

<p>The restrict and regexRestrict functions and the alphanumeric plugin replacement that uses these functions can be <a href="http://github.com/treyhunner/jquery-formrestrict">found on github</a>.</p>
]]></content>
  </entry>
  
</feed>
